#!/usr/bin/env bash

# Paso 1: Eliminar cualquier directiva "Banner" previa en sshd_config
sudo sed -i '/^[[:space:]]*Banner[[:space:]]\+/d' /etc/ssh/sshd_config

# Paso 2: Crear el archivo de banner en /etc/ssh/sshd-banner
sudo tee /etc/ssh/sshd-banner > /dev/null << 'EOF'

 AUTHORIZED USE ONLY 

This system is the property of the organization and may be accessed only by authorized users. 
By continuing to use this system, you acknowledge and consent to monitoring, recording, and 
review of all activity for security and administrative purposes.

There is no expectation of privacy. Unauthorized access or misuse is strictly prohibited and 
may result in disciplinary action, civil penalties, and criminal prosecution.

If you are not an authorized user, disconnect immediately.

EOF

# Paso 3: Agregar la línea correcta 'Banner /etc/ssh/sshd-banner' a sshd_config
echo "Banner /etc/ssh/sshd-banner" | sudo tee -a /etc/ssh/sshd_config > /dev/null
echo "¡Listo! El banner pre login de OpenSSH ha sido configurado."

# Paso 4: Reiniciar el servicio sshd para aplicar los cambios
sudo systemctl restart sshd

# Paso 5: Agregar alias para editar el banner fácilmente
echo "alias bannere='sudo nano /etc/ssh/sshd-banner'" >> ~/.zshrc