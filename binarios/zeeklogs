#!/usr/bin/env bash
# Men√∫ interactivo para visualizar logs de Zeek en /opt/zeek/spool/zeek

LOGDIR="/opt/zeek/spool/zeek"

# Verifica existencia
if ! sudo test -d "$LOGDIR"; then
    echo -e "\e[91m‚ùå No existe $LOGDIR\e[0m"
    exit 1
fi

while true; do
    echo -e "\n\e[96m=== Archivos disponibles en $LOGDIR ===\e[0m"
    mapfile -t files < <(sudo ls -1 "$LOGDIR")
    files+=("Salir")

    select file in "${files[@]}"; do
        if [[ "$file" == "Salir" ]]; then
            echo -e "\e[93müëã Saliendo...\e[0m"
            exit 0
        elif [[ -n "$file" ]]; then
            echo -e "\n\e[92m‚ñ∂ Mostrando: $LOGDIR/$file\e[0m"
            echo -e "\e[95m(Usa q para salir y volver al men√∫)\e[0m\n"
            sudo less -RS "$LOGDIR/$file"
            break
        else
            echo -e "\e[91mOpci√≥n inv√°lida\e[0m"
        fi
    done
done